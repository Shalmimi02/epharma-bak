"use strict";(self["webpackChunkepharma"]=self["webpackChunkepharma"]||[]).push([[612],{40612:(t,e,a)=>{a.r(e),a.d(e,{default:()=>I});var o=a(56768),d=a(45130),n=a(24232),r=function(t){return(0,o.Qi)("data-v-2b431b86"),t=t(),(0,o.jt)(),t},s=r((function(){return(0,o.Lk)("p",null,[(0,o.eW)("Pour que l'importation fonctionne, la première ligne qui correspond aux entetes de votre tableau doit contenir les noms des colonnes suivant ecrit de la meme maniere peu importe l'ordre "),(0,o.Lk)("b",null,"sans espace svp"),(0,o.eW)(". ")],-1)})),X={key:0,class:"import-response danger"},i=r((function(){return(0,o.Lk)("h3",null,"Résultat de l'importation",-1)})),b=r((function(){return(0,o.Lk)("strong",null,"Nombre total de produits importés :",-1)})),l=r((function(){return(0,o.Lk)("strong",null,"Nombre de produits ignorés :",-1)})),c={key:0},u=r((function(){return(0,o.Lk)("p",null,[(0,o.Lk)("strong",null,"Liste des produits ignorés :")],-1)})),p={key:1},v=r((function(){return(0,o.Lk)("p",null,"Aucun produit ignoré.",-1)})),h=[v],m=(0,o.Fv)('<div class="card card-body overflow-auto p-0 mb-3" data-v-2b431b86><table class="table table-bordered overflow-auto" data-v-2b431b86><thead data-v-2b431b86><tr class="bg-danger text-white" data-v-2b431b86><th scope="col" data-v-2b431b86>1</th><th scope="col" data-v-2b431b86>libelle</th><th scope="col" data-v-2b431b86>forme</th><th scope="col" data-v-2b431b86>prix_achat</th><th scope="col" data-v-2b431b86>prix_de_vente</th><th scope="col" data-v-2b431b86>coef_conversion_de_prix_vente_achat</th><th scope="col" data-v-2b431b86>tva</th><th scope="col" data-v-2b431b86>css</th><th scope="col" data-v-2b431b86>nature</th><th scope="col" data-v-2b431b86>categorie</th><th scope="col" data-v-2b431b86>cip</th><th scope="col" data-v-2b431b86>cip_deux</th><th scope="col" data-v-2b431b86>statut</th><th scope="col" data-v-2b431b86>dci</th><th scope="col" data-v-2b431b86>code_table</th><th scope="col" data-v-2b431b86>hauteur</th><th scope="col" data-v-2b431b86>largeur</th><th scope="col" data-v-2b431b86>longueur</th><th scope="col" data-v-2b431b86>poids</th><th scope="col" data-v-2b431b86>classe_therapeutique</th><th scope="col" data-v-2b431b86>qte</th><th scope="col" data-v-2b431b86>qte_min</th><th scope="col" data-v-2b431b86>qte_max</th><th scope="col" data-v-2b431b86>photo</th><th scope="col" data-v-2b431b86>posologie</th><th scope="col" data-v-2b431b86>description</th><th scope="col" data-v-2b431b86>homologation</th><th scope="col" data-v-2b431b86>rayon</th></tr></thead><tbody data-v-2b431b86><tr data-v-2b431b86><th data-v-2b431b86>2</th><td data-v-2b431b86>XXXXXXX</td><td data-v-2b431b86>XXXXXXX</td><td data-v-2b431b86>XXXXXXX</td><td data-v-2b431b86>XXXXXXX</td><td data-v-2b431b86>XXXXXXX</td><td data-v-2b431b86>XXXXXXX</td><td data-v-2b431b86>XXXXXXX</td><td data-v-2b431b86>XXXXXXX</td><td data-v-2b431b86>XXXXXXX</td><td data-v-2b431b86>XXXXXXX</td><td data-v-2b431b86>XXXXXXX</td><td data-v-2b431b86>XXXXXXX</td><td data-v-2b431b86>XXXXXXX</td><td data-v-2b431b86>XXXXXXX</td><td data-v-2b431b86>XXXXXXX</td><td data-v-2b431b86>XXXXXXX</td><td data-v-2b431b86>XXXXXXX</td><td data-v-2b431b86>XXXXXXX</td><td data-v-2b431b86>XXXXXXX</td><td data-v-2b431b86>XXXXXXX</td><td data-v-2b431b86>XXXXXXX</td><td data-v-2b431b86>XXXXXXX</td><td data-v-2b431b86>XXXXXXX</td><td data-v-2b431b86>XXXXXXX</td><td data-v-2b431b86>XXXXXXX</td><td data-v-2b431b86>XXXXXXX</td><td data-v-2b431b86>XXXXXXX</td></tr></tbody></table></div><div class="text-center mt-3" data-v-2b431b86><a href="/BASE DE DONNEES EPHARMA2024 OK.xlsx" download class="btn btn-secondary" data-v-2b431b86> Télécharger l&#39;exemple </a></div><p class="text-center" data-v-2b431b86>Les produits avec une quantité (qte) supériéure à 0 seront automatiquement activés dans les produits</p>',3),f={class:"form-group"},g=r((function(){return(0,o.Lk)("label",null,[(0,o.eW)("Votre fichier excel doit avoir l'extension "),(0,o.Lk)("span",{class:"text-danger"},".xlsx")],-1)})),k=["disabled"],x={key:0},y=r((function(){return(0,o.Lk)("span",{class:"spinner-border spinner-border-sm mx-2",role:"status","aria-hidden":"true"},null,-1)}));function _(t,e,a,r,v,_){var L=(0,o.g2)("spa");return(0,o.uX)(),(0,o.CE)(o.FK,null,[s,(0,o.bF)(d.eB,{name:"slide-down"},{default:(0,o.k6)((function(){return[v.showResponse?((0,o.uX)(),(0,o.CE)("div",X,[i,(0,o.Lk)("p",null,[b,(0,o.eW)(" "+(0,n.v_)(v.importResponse.data.nb_importations),1)]),(0,o.Lk)("p",null,[l,(0,o.eW)(" "+(0,n.v_)(v.importResponse.data.nb_importations_ignores),1)]),v.importResponse.data.importations_ignores.length>0?((0,o.uX)(),(0,o.CE)("div",c,[u,(0,o.Lk)("ul",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(v.importResponse.data.importations_ignores,(function(t,e){return(0,o.uX)(),(0,o.CE)("li",{key:e},(0,n.v_)(t),1)})),128))])])):((0,o.uX)(),(0,o.CE)("div",p,h))])):(0,o.Q3)("",!0)]})),_:1}),m,(0,o.Lk)("form",{onSubmit:e[1]||(e[1]=(0,d.D$)((function(){return _.runImport&&_.runImport.apply(_,arguments)}),["prevent"])),class:"col-md-10 mx-auto"},[(0,o.Lk)("div",f,[g,(0,o.Lk)("input",{class:"form-control",type:"file",onChange:e[0]||(e[0]=function(){return _.handleFileChange&&_.handleFileChange.apply(_,arguments)}),ref:"fileInput"},null,544)]),v.excelData.length?((0,o.uX)(),(0,o.CE)("button",{key:0,type:"submit",class:"btn btn-primary btn-block",disabled:v.isLoading},[1==v.isLoading?((0,o.uX)(),(0,o.CE)("div",x,[(0,o.eW)(" Importation en cours "),y])):((0,o.uX)(),(0,o.Wv)(L,{key:1},{default:(0,o.k6)((function(){return[(0,o.eW)("Démarrer")]})),_:1}))],8,k)):(0,o.Q3)("",!0)],32)],64)}a(51629),a(62062),a(34782),a(11745),a(38309),a(16573),a(78100),a(77936),a(60739),a(33110),a(26099),a(21489),a(48140),a(81630),a(72170),a(75044),a(69539),a(31694),a(89955),a(21903),a(91134),a(33206),a(44496),a(66651),a(12887),a(19369),a(66812),a(8995),a(31575),a(36072),a(88747),a(28845),a(29423),a(57301),a(373),a(86614),a(41405),a(37467),a(44732),a(33684),a(79577),a(23500);var L=a(46587),E=a.n(L),C=a(93230);const w={inject:["dialogRef"],data:function(){return{isLoading:!1,excelData:[],showResponse:!1,importResponse:{}}},computed:{formattedJson:function(){return JSON.stringify(this.excelData,null,2)}},methods:{handleFileChange:function(t){var e=this,a=t.target.files[0];if(a){var o=new FileReader;o.onload=function(t){var a=new Uint8Array(t.target.result),o=C.LF(a,{type:"array"}),d=o.SheetNames[0],n=o.Sheets[d],r=C.Wp.sheet_to_json(n,{header:1}),s=r[0],X=r.slice(1);e.excelData=X.map((function(t){var e={};return s.forEach((function(a,o){e[a]=t[o]})),e}))},o.readAsArrayBuffer(a)}},runImport:function(){var t=this;this.isLoading=!0,this.axios.post("/api/produits/import-excel",{produits:this.excelData}).then((function(e){t.isLoading=!1,!0===e.data.success?(t.excelData=[],t.$refs.fileInput&&(t.$refs.fileInput.value=null),E()("#refreshproduits").click(),t.$toast.add({severity:"success",detail:"Importation réussie",life:3e3}),t.importResponse=e.data,t.showResponse=!0):e.data.errors.forEach((function(e){t.$toast.add({severity:"warn",summary:"Oups !",detail:e,life:7e3})}))}))["catch"]((function(){t.isLoading=!1,t.$toast.add({severity:"error",summary:"Probleme de connexion",detail:"Une erreur s'est produite lors de la connexion au serveur !",life:5e3})}))}}};var R=a(71241);const D=(0,R.A)(w,[["render",_],["__scopeId","data-v-2b431b86"]]),I=D}}]);
//# sourceMappingURL=612.e4fe133f.js.map